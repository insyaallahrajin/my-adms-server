FROM node:18-alpine

WORKDIR /app

# Install Encore CLI
RUN npm install -g @encore/cli

# Copy package files
COPY backend/package*.json ./backend/
RUN cd backend && npm install

# Copy backend source code
COPY backend ./backend

# Set working directory to backend
WORKDIR /app/backend

# Expose port
EXPOSE 5000

# Start the backend
CMD ["encore", "run", "--listen", "0.0.0.0:5000"]
